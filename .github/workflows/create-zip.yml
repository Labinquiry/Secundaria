name: Create ZIP

on:
  push:
    branches:
      - main  # Cambia a la rama que prefieras
  workflow_dispatch:

permissions:
  contents: write  # Permisos para leer y escribir contenido

jobs:
  create-zip:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: List directory contents
      run: |
        echo "Contenido del directorio ra√≠z:"
        ls -la
        echo "Contenido de la carpeta REI-Combinatoria:"
        ls -la "REI-Combinatoria"
        echo "Contenido de la carpeta REI-Recogida-de-datos:"
        ls -la "REI-Recogida-de-datos"

    - name: Create ZIP for REI-Combinatoria
      run: |
        zip -r output.zip REI-Recogida-de-datos
      shell: bash

    - name: Create ZIP for REI-Recogida-de-datos
      run: |
        zip -r output.zip REI-Combinatoria
      shell: bash

    - name: Create or Update Release
      id: create_release
      uses: softprops/action-gh-release@v1
      with:
        tag_name: latest
        name: Release for latest changes
        files: |
          REI-Combinatoria.zip
          REI-Recogida-de-datos.zip
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    - name: Upload REI-Combinatoria ZIP to Release
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: REI-Combinatoria.zip
        asset_name: REI-Combinatoria.zip
        asset_content_type: application/zip
  
    - name: Upload REI-Recogida-de-datos ZIP to Release
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: REI-Recogida-de-datos.zip
        asset_name: REI-Recogida-de-datos.zip
        asset_content_type: application/zip
